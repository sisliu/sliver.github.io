---
layout:     post
title:      "谈谈js函数内部属性"
subtitle:   " \"js函数内部属性\""
date:       2020-04-10 15:50:24
author:     "ZH"
header-img: "img/home-bg-art.jpg"
catalog: true
tags:
    - 随笔
---

## 前言
看js高级程序设计，真的是受益颇多。学到了很多以前不知道的知识，忍不住就想记录下来。

## 正文
### callee属性
在函数内部，有两个特殊的对象：arguments和this。arguments的主要用途是保存函数参数，但这个对象还有一个名叫callee属性。该属性是一个指针，指向拥有这个arguments对象的函数。    
看例子    
```
function factorial(num){
    if(num <=1){
        return 1
    } else {
        return num*factorial(num-1)
    }
}
```
学过算法的一眼就知道这是个经典的阶乘函数，用到了递归思想。这个代码没有任何问题，但是问题在于，这个函数的执行与函数名factorial紧紧耦合在了一起。为了消除这种紧密耦合的现象，可以使用arguments.callee。    
```
function factorial(num){
    if(num <=1){
        return 1
    } else {
        return num*arguments.callee(num-1)
    }
}
```
在这里我们就把紧密耦合的现象给消除掉了。无论引用函数时候使用的是什么名字，都可以保证正常完成递归调用。    
例如    
```
var trueFactorial = factorial
factorial = function(){
    return 0
}
trueFactorial(5) //120
factorial(5) // 0
```
在这里，我们可以看到虽然factorial重新赋予另一个函数，但是调用
trueFactorial(5)依然还是可以调用阶乘，但是factorial调用就是0了，如果不采用arguments.callee，改变factorial指针指向，trueFactorial也会是0。    
### this属性
其实this我写过专门一篇博客讲述过，既然看到了那就再总结一下吧    
一句话，this引用的是函数据以执行的环境。或者也可以说是this值。来看下面例子    
```
window.color = "red"
var o = { color: "blue" }
function sayColor() {
    alert(this.color)
}
sayColor() //"red"
o.sayColor = sayColor
o.sayColor() // "blue"
```
上面这个例子，函数sayColor是在全局作用域中定义的，引用了this对象。在调用函数之前，this的值并不确定，也就是说，可能会在代码执行中引用不同对象。挡在全局作用域中调用sayColor时，引用的就是全局对象window，也就是会打印red。而把这个函数赋值给对象o并调用o.sayColor()，这时候this引用的对象就是o.所以打印出blue。    
<font color = orange>我们需要记住的是，函数的名字仅仅是一个包含指针的变量而已。因此，即使是在不同环境执行，全局的sayColor函数与o.sayColor指向的仍然是同一个函数。</font>    
在es5种对caller规范化了，这个属性保存着调用当前函数的行数的引用，如果在全局作用域中调用当前函数，它的值为null。    
```
function outer() {
    inner()
}
function inner(){
    alert (inner.caller) // outer函数的源代码
}
outer()
```
在这个例子中，因为outer调用了inner，在inner内部实现了caller，所以这时候inner.caller就会指向outer()。为了实现更加松散的耦合，也可以通过arguments.callee.caller来实现同样的功能。    
在严格模式下，访问arguments.callee会导致错误。严格模式还有一个限制，不能为函数的caller属性赋值。